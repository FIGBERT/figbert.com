www.figbert.com {
	redir https://figbert.com{uri}
	header -Server
}

figbert.com {
	root * /usr/share/caddy
	encode zstd gzip
	file_server
	header {
		-Server
		Content-Security-Policy "default-src 'none'; script-src https://gc.zgo.at; img-src 'self' https://figbert.goatcounter.com/count; media-src 'self'; style-src 'self'; frame-ancestors 'none'; base-uri 'none'; form-action 'none';" 
		Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
		Feature-Policy "accelerometer 'none'; ambient-light-sensor 'none'; autoplay 'self'; battery 'none'; camera 'none'; display-capture 'none'; document-domain 'none'; encrypted-media 'none'; execution-while-not-rendered 'none'; execution-while-out-of-viewport 'none'; fullscreen 'self'; geolocation 'none'; gyroscope 'none'; layout-animations 'none'; legacy-image-formats 'self'; magnetometer 'none'; microphone 'none'; midi 'none'; navigation-override 'none'; oversized-images 'self'; payment 'none'; picture-in-picture 'self'; publickey-credentials-get 'none'; sync-xhr 'none'; usb 'none'; vr 'none'; wake-lock 'none'; xr-spatial-tracking 'none';"
		X-Content-Type-Options nosniff
		X-Frame-Options DENY
		X-XSS-Protection "1; mode=block"
		Referrer-Policy strict-origin-when-cross-origin
		Cache-Control max-age=2419200
	}
	handle_errors {
  		@404 {
    			expression {http.error.status_code} == 404
  		}
  		handle @404 {
    			rewrite 404.html
  		}
  		file_server
	}
}

